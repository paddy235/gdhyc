<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhiren.fuelmis.dc.dao.yuebgl.yuebwh.ZhibqkDao">
	<!--mod取余函数  -->
	<select id="getAllName_Left" resultType="java.util.Map">
		SELECT ZIDM,MINGC,GONGS,DANW FROM YUEZBDYB WHERE MOD(XUH,2)= 1 AND DIANCXXB_ID = #{dianc} ORDER BY XUH
	</select>
	
	<select id="getAllName_Right" resultType="java.util.Map">
		SELECT ZIDM,MINGC,GONGS,DANW FROM YUEZBDYB WHERE MOD(XUH,2)= 0 AND DIANCXXB_ID = #{dianc} ORDER BY XUH
	</select>
	<select id="getAllValue" resultType="java.util.Map">
		${sqls} FROM YUEZBB WHERE RIQ = '${riq}' AND DIANCXXB_ID = #{dianc} ORDER BY ID ASC
	</select>
	<!-- 获取全部字段名称 -->
	<select id="getAllNames" resultType="java.util.Map">
		SELECT ZIDM,MINGC,GONGS,LEIJGS FROM YUEZBDYB  WHERE  DIANCXXB_ID = #{dianc} ORDER BY XUH 
	</select>
	<!-- 获取累计数据 -->
	<select id="getLeijData" resultType="java.util.Map">
		${leijsql} FROM YUEZBB WHERE FENX='本月' AND  DIANCXXB_ID =${dianc}  and riq between substr('${riq}',0,4)||'-01'  and '${riq}'  GROUP BY FENX
	</select>
	<!-- 插入累计数据 -->
	<insert id="inLeijData" parameterType="java.util.Map">
		INSERT INTO YUEZBB(id,diancxxb_id,riq,fenx,RULTRMPJFRL ,RULMZBZML,FADYTRML,GONGRYTRML,FADYTRYL,GONGRYTRYL,RULTRQPJFRL ,FADYTRQL,GONGRYTRQL,
			FADL,FADCGDL ,GONGRCGDL,GONGRL,FADMCB,FADYCB,GONGRMCB,GONGRYCB,FADRQCB ,GONGRRQCB,QIZ_RANM,
			QIZ_RANY,QIZ_RANQ,FADMZBML,GONGRMZBML,RULTRYPJFRL ,FADYZBZML,GONGRYZBZML ,FADQZBZML,
			GONGRQZBZML ,FADBZMDJ,QIZ_MEIZBMDJ,QIZ_YOUZBMDJ,QIZ_QIZBMDJ ,GONGRBZMDJ,QIZ_MEIZBMDJ_GR ,QIZ_YOUZBMDJ_GR ,
			QIZ_QIZBMDJ_GR,RULZHBMDJ,FADGRYTRML)
		VALUES(${id},${dianc},'${riq}','累计',${RULTRMPJFRL},${RULMZBZML},${FADYTRML},${GONGRYTRML},${FADYTRYL},${GONGRYTRYL},${RULTRQPJFRL},${FADYTRQL},${GONGRYTRQL},
			${FADL},${FADCGDL},${GONGRCGDL},${GONGRL},${FADMCB},${FADYCB},${GONGRMCB},${GONGRYCB},${FADRQCB},${GONGRRQCB},${QIZ_RANM},
			${QIZ_RANY},${QIZ_RANQ},${FADMZBML},${GONGRMZBML},${RULTRYPJFRL},${FADYZBZML},${GONGRYZBZML},${FADQZBZML},
			${GONGRQZBZML},${FADBZMDJ},${QIZ_MEIZBMDJ},${QIZ_YOUZBMDJ},${QIZ_QIZBMDJ},${GONGRBZMDJ},${QIZ_MEIZBMDJ_GR},${QIZ_YOUZBMDJ_GR},
			${QIZ_QIZBMDJ_GR},${RULZHBMDJ},${FADGRYTRML})
	</insert>
	<!-- 插入填报项 -->
	<insert id="saveTbData" parameterType="java.util.Map">
		INSERT INTO YUEZBB (id,diancxxb_id,riq,fenx,RULTRQPJFRL,FADYTRQL,GONGRYTRQL,FADL,FADCGDL,GONGRCGDL,
				GONGRL,FADMCB,FADYCB,GONGRMCB,GONGRYCB,FADRQCB ,GONGRRQCB,QIZ_RANM,QIZ_RANY,
				QIZ_RANQ,KUCTRMRZ,KUCTRMJ ,RULTRYPJFRL ,RULTRMPJFRL ,FADYTRML,GONGRYTRML,
				FADYTRYL,GONGRYTRYL)
		VALUES (${id},${dianc},'${riq}','本月',${RULTRQPJFRL},${FADYTRQL},${GONGRYTRQL},${FADL},${FADCGDL},${GONGRCGDL},
				${GONGRL},${FADMCB},${FADYCB},${GONGRMCB},${GONGRYCB},${FADRQCB},${GONGRRQCB},${QIZ_RANM},${QIZ_RANY},
				${QIZ_RANQ},${KUCTRMRZ},${KUCTRMJ},${RULTRYPJFRL},${RULTRMPJFRL},${FADYTRML},${GONGRYTRML},
				${FADYTRYL},${GONGRYTRYL})
	</insert>
	<!-- 修改填报项 -->
	<update id="updateTbDate" parameterType="java.util.Map">
		UPDATE YUEZBB SET 
			RULTRQPJFRL=${RULTRQPJFRL},
			FADYTRQL=${FADYTRQL},
			GONGRYTRQL=${GONGRYTRQL},
			FADL=${FADL},
			FADCGDL=${FADCGDL},
			GONGRCGDL=${GONGRCGDL},
			GONGRL=${GONGRL},
			FADMCB=${FADMCB},
			FADYCB=${FADYCB},
			GONGRMCB=${GONGRMCB},
			GONGRYCB=${GONGRYCB},
			FADRQCB=${FADRQCB},
			GONGRRQCB=${GONGRRQCB},
			QIZ_RANM=${QIZ_RANM},
			QIZ_RANY=${QIZ_RANY},
			QIZ_RANQ=${QIZ_RANQ},
			KUCTRMRZ=${KUCTRMRZ},
			KUCTRMJ=${KUCTRMJ},
			RULTRYPJFRL=${RULTRYPJFRL},
			RULTRMPJFRL=${RULTRMPJFRL},
			FADYTRML=${FADYTRML},
			GONGRYTRML=${GONGRYTRML},
			FADYTRYL=${FADYTRYL},
			GONGRYTRYL=${GONGRYTRYL}
		WHERE substr(RIQ,0,7) = '${riq}' AND DIANCXXB_ID =${dianc}  and fenx ='本月'
	</update>
	<update id="updateData" parameterType="java.util.Map">
		UPDATE YUEZBB SET 
			RULTRMPJFRL=${RULTRMPJFRL}, RULMZBZML=${RULMZBZML},FADYTRML=${FADYTRML}, GONGRYTRML=${GONGRYTRML}, 
			 FADYTRYL=${FADYTRYL}, GONGRYTRYL=${GONGRYTRYL}, RULTRQPJFRL=${RULTRQPJFRL}, FADYTRQL=${FADYTRQL}, 
			 GONGRYTRQL=${GONGRYTRQL}, FADL=${FADL}, FADCGDL=${FADCGDL}, GONGRCGDL=${GONGRCGDL}, GONGRL=${GONGRL}, 
			 FADMCB=${FADMCB}, FADYCB=${FADYCB}, GONGRMCB=${GONGRMCB}, GONGRYCB=${GONGRYCB}, FADRQCB=${FADRQCB}, 
			 GONGRRQCB=${GONGRRQCB}, QIZ_RANM=${QIZ_RANM}, QIZ_RANY=${QIZ_RANY}, QIZ_RANQ=${QIZ_RANQ}, FADMZBML=${FADMZBML},
			 GONGRMZBML=${GONGRMZBML}, RULTRYPJFRL=${RULTRYPJFRL}, FADYZBZML=${FADYZBZML}, GONGRYZBZML=${GONGRYZBZML},
			 FADQZBZML=${FADQZBZML}, GONGRQZBZML=${GONGRQZBZML}, FADBZMDJ=${FADBZMDJ}, QIZ_MEIZBMDJ=${QIZ_MEIZBMDJ}, 
			 QIZ_YOUZBMDJ=${QIZ_YOUZBMDJ}, QIZ_QIZBMDJ=${QIZ_QIZBMDJ}, GONGRBZMDJ=${GONGRBZMDJ}, QIZ_MEIZBMDJ_GR=${QIZ_MEIZBMDJ_GR},
			 QIZ_YOUZBMDJ_GR=${QIZ_YOUZBMDJ_GR}, QIZ_QIZBMDJ_GR=${QIZ_QIZBMDJ_GR}, RULZHBMDJ=${RULZHBMDJ},
			 FADGRYTRML = ${FADGRYTRML},FADGRYTRYL = ${FADGRYTRYL},FADGRYTRQL = ${FADGRYTRQL},FADBZMH = ${FADBZMH},
			 GONGRBZMH = ${GONGRBZMH},RANLCB_BHS = ${RANLCB_BHS} 
		WHERE substr(RIQ,0,7)= '${riq}' AND DIANCXXB_ID=${dianc} and fenx ='本月'
	</update>
	<!-- 更新累计数据 -->
	<update id="upLeijData" parameterType="java.util.Map">
		UPDATE YUEZBB SET
			 RULTRMPJFRL=${RULTRMPJFRL}, RULMZBZML=${RULMZBZML},FADYTRML=${FADYTRML}, GONGRYTRML=${GONGRYTRML}, 
			 FADYTRYL=${FADYTRYL}, GONGRYTRYL=${GONGRYTRYL}, RULTRQPJFRL=${RULTRQPJFRL}, FADYTRQL=${FADYTRQL}, 
			 GONGRYTRQL=${GONGRYTRQL}, FADL=${FADL}, FADCGDL=${FADCGDL}, GONGRCGDL=${GONGRCGDL}, GONGRL=${GONGRL}, 
			 FADMCB=${FADMCB}, FADYCB=${FADYCB}, GONGRMCB=${GONGRMCB}, GONGRYCB=${GONGRYCB}, FADRQCB=${FADRQCB}, 
			 GONGRRQCB=${GONGRRQCB}, QIZ_RANM=${QIZ_RANM}, QIZ_RANY=${QIZ_RANY}, QIZ_RANQ=${QIZ_RANQ}, FADMZBML=${FADMZBML},
			 GONGRMZBML=${GONGRMZBML}, RULTRYPJFRL=${RULTRYPJFRL}, FADYZBZML=${FADYZBZML}, GONGRYZBZML=${GONGRYZBZML},
			 FADQZBZML=${FADQZBZML}, GONGRQZBZML=${GONGRQZBZML}, FADBZMDJ=${FADBZMDJ}, QIZ_MEIZBMDJ=${QIZ_MEIZBMDJ}, 
			 QIZ_YOUZBMDJ=${QIZ_YOUZBMDJ}, QIZ_QIZBMDJ=${QIZ_QIZBMDJ}, GONGRBZMDJ=${GONGRBZMDJ}, QIZ_MEIZBMDJ_GR=${QIZ_MEIZBMDJ_GR},
			 QIZ_YOUZBMDJ_GR=${QIZ_YOUZBMDJ_GR}, QIZ_QIZBMDJ_GR=${QIZ_QIZBMDJ_GR}, RULZHBMDJ=${RULZHBMDJ},
			 FADGRYTRML = ${FADGRYTRML},FADGRYTRYL = ${FADGRYTRYL},FADGRYTRQL = ${FADGRYTRQL},FADBZMH = ${FADBZMH},
			 GONGRBZMH = ${GONGRBZMH},RANLCB_BHS = ${RANLCB_BHS} 
		WHERE substr(RIQ,0,7)='${riq}' AND FENX='累计'
	</update>
	<!-- 删除月指标 -->
	<delete id="delData" parameterType="java.util.Map">
		DELETE FROM YUEZBB  WHERE substr(RIQ,0,7) = '${riq}' AND DIANCXXB_ID=${dianc}
	</delete>
	
</mapper>